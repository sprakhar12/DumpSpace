<div class="page">
  <div class="header">
    <h2>Videos</h2>
    <p class="hint">Your uploaded videos</p>
  </div>

  <ng-container *ngIf="videos$ | async as videos">
    <div class="empty" *ngIf="!videos.length">No videos yet.</div>

    <div class="grid" *ngIf="videos.length">
      <div class="card" *ngFor="let media of videos" (click)="openPreview(media, $event)">
        <div class="thumb">
          <video [src]="media.downloadUrl" muted playsinline preload="metadata"></video>
          <div class="play">â–¶</div>
        </div>

        <div class="meta">
          <div class="name" [title]="media.originalName || media.name">
            {{ media.originalName || media.name }}
          </div>

          <div class="submeta">
            <div class="left">
              <span>{{ (media.size / 1024 / 1024) | number:'1.0-1' }} MB</span>
            </div>

            <div class="right" (click)="$event.stopPropagation()">
              <button mat-icon-button class="iconBtn dl" aria-label="Download"
                      (click)="download(media, $event)">
                <mat-icon>download</mat-icon>
              </button>
              <button mat-icon-button class="iconBtn danger" aria-label="Delete"
                      (click)="delete(media, $event)">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </ng-container>

  <!-- Modal preview -->
  <div class="backdrop" *ngIf="previewUrl" (click)="closePreview()">
    <div class="modal" (click)="$event.stopPropagation()">
      <div class="modalTop">
        <div class="modalTitle">{{ previewName }}</div>
        <button mat-icon-button aria-label="Close" (click)="closePreview()">
          <mat-icon>close</mat-icon>
        </button>
      </div>

      <video class="modalMedia" [src]="previewUrl" controls playsinline></video>
    </div>
  </div>
</div>