<div class="upload-page">
  <div class="header">
    <h2>Upload to DumpSpace</h2>
    <p class="hint">Drag & drop images/videos here, or browse.</p>
  </div>

  <!-- Dropzone -->
  <label
    class="dropzone"
    [class.disabled]="uploading"
    role="button"
    tabindex="0"
  >
    <div class="dropzone-inner">
      <div class="icon">⬆️</div>
      <div class="title">Tap to choose files</div>
      <div class="sub">or drag & drop on desktop</div>
      <div class="types">PNG • JPG • WEBP • HEIC • MP4 • MOV • WEBM</div>
    </div>

    <input
      class="file-input"
      type="file"
      accept="image/*,video/*"
      multiple
      (change)="onFilePicked($event)"
      [disabled]="uploading"
    />
  </label>

  <!-- Selected files -->
  <div class="list" *ngIf="files.length">
    <div class="list-head">
      <div class="count">{{ files.length }} file(s) ready</div>
      <button class="ghost" type="button" (click)="clear()" [disabled]="uploading">Clear</button>
    </div>

    <div class="grid">
      <div class="card" *ngFor="let f of files; let i = index">
        <div class="thumb">
          <img *ngIf="f.previewType === 'image'" [src]="f.previewUrl" alt="preview" />
          <video
            *ngIf="f.previewType === 'video'"
            [src]="f.previewUrl"
            muted
            playsinline
            preload="metadata"
            controls
          ></video>
        </div>

        <div class="meta">
          <div class="name" [title]="f.name">{{ f.name }}</div>
          <div class="submeta">
            <span>{{ formatBytes(f.size) }}</span>
          </div>
        </div>

        <button class="remove" type="button" (click)="remove(i)" [disabled]="uploading">✕</button>
      </div>
    </div>

    <div class="actions">
      <button class="btn" type="button" (click)="upload()" [disabled]="uploading || !files.length">
        {{ uploading ? 'Uploading…' : 'Upload' }}
      </button>

      <div class="progress-wrap" *ngIf="uploading">
        <div class="progress">
          <div class="bar" [style.width.%]="progress"></div>
        </div>
        <div class="pct">{{ progress }}%</div>
      </div>

      <p class="error" *ngIf="error">{{ error }}</p>
    </div>
  </div>
</div>